Sub CopyGoldman_To_CONCILIACION_AndClean()
    Dim wsDATA As Worksheet, wsCONC As Worksheet, wsGold As Worksheet
    Dim lastRowGold As Long, lastColGold As Long
    Dim lastRowConc As Long, i As Long
    Dim valD As String, valK As String, valA As String, p As Long

    On Error Resume Next
    Set wsDATA = ThisWorkbook.Sheets("DATA")
    Set wsCONC = ThisWorkbook.Sheets("CONCILIACIÓN")
    If wsCONC Is Nothing Then Set wsCONC = ThisWorkbook.Sheets("CONCILIACION")
    Set wsGold = ThisWorkbook.Sheets("GOLDMAN")
    On Error GoTo 0

    If wsDATA Is Nothing Or wsCONC Is Nothing Or wsGold Is Nothing Then
        MsgBox "Required sheets not found (DATA / CONCILIACIÓN / GOLDMAN).", vbCritical
        Exit Sub
    End If

    Application.ScreenUpdating = False
    Application.EnableEvents = False

    ' 1) Clean DATA and CONCILIACIÓN
    wsDATA.Cells.Clear
    wsCONC.Cells.Clear

    ' 2) Copy all content from GOLDMAN to CONCILIACIÓN
    lastRowGold = wsGold.Cells(wsGold.Rows.Count, "A").End(xlUp).Row
    lastColGold = wsGold.Cells(1, wsGold.Columns.Count).End(xlToLeft).Column
    If lastRowGold >= 1 And lastColGold >= 1 Then
        wsGold.Range(wsGold.Cells(1, 1), wsGold.Cells(lastRowGold, lastColGold)).Copy wsCONC.Range("A1")
    End If

    ' 3) Delete rows in CONCILIACIÓN where column D says "Sell / Buy"
    lastRowConc = wsCONC.Cells(wsCONC.Rows.Count, "D").End(xlUp).Row
    For i = lastRowConc To 2 Step -1
        valD = UCase$(Replace(Trim$(CStr(wsCONC.Cells(i, "D").Value)), " ", ""))
        If valD = "SELL/BUY" Then
            wsCONC.Rows(i).Delete
        End If
    Next i

    ' 4) Delete rows in CONCILIACIÓN where column K says "cardej"
    lastRowConc = wsCONC.Cells(wsCONC.Rows.Count, "K").End(xlUp).Row
    For i = lastRowConc To 2 Step -1
        valK = UCase$(Trim$(CStr(wsCONC.Cells(i, "K").Value)))
        If valK = "CARDEJ" Then
            wsCONC.Rows(i).Delete
        End If
    Next i

    ' 5) Clean column A: keep only the date (remove the time part)
    lastRowConc = wsCONC.Cells(wsCONC.Rows.Count, "A").End(xlUp).Row
    For i = 2 To lastRowConc
        valA = Trim(CStr(wsCONC.Cells(i, "A").Value))
        If Len(valA) > 0 Then
            p = InStrRev(valA, " ")
            If p > 0 Then
                wsCONC.Cells(i, "A").Value = Mid$(valA, p + 1 - 3) ' take from date part
                wsCONC.Cells(i, "A").Value = Mid$(valA, InStr(valA, " ") + 1) ' safer: drop everything up to first space
            End If
        End If
    Next i

    MsgBox "Copied GOLDMAN into CONCILIACIÓN, removed 'Sell / Buy' (D), 'cardej' (K), and cleaned dates in A.", vbInformation

    Application.CutCopyMode = False
    Application.EnableEvents = True
    Application.ScreenUpdating = True
End Sub