Option Explicit

Public Sub INT_ImportCSV_ToDATA_Simple()
    Dim fd As FileDialog
    Dim filePath As String
    Dim wsDATA As Worksheet, wsCONC As Worksheet
    Dim wbTemp As Workbook, wsTemp As Worksheet

    On Error GoTo ErrHandler
    Application.ScreenUpdating = False
    Application.EnableEvents = False

    ' 0) Sheets
    On Error Resume Next
    Set wsDATA = ThisWorkbook.Sheets("DATA")
    Set wsCONC = ThisWorkbook.Sheets("CONCILIACIÓN")
    If wsCONC Is Nothing Then Set wsCONC = ThisWorkbook.Sheets("CONCILIACION")
    On Error GoTo ErrHandler

    If wsDATA Is Nothing Or wsCONC Is Nothing Then
        MsgBox "No se encontraron las hojas (DATA / CONCILIACIÓN).", vbCritical
        GoTo TidyExit
    End If

    ' 1) Clean both sheets
    wsDATA.Cells.Clear
    wsCONC.Cells.Clear

    ' 2) Pick file
    Set fd = Application.FileDialog(msoFileDialogFilePicker)
    With fd
        .Title = "Seleccionar archivo CSV / TXT"
        .Filters.Clear
        .Filters.Add "Text/CSV", "*.csv;*.txt"
        .AllowMultiSelect = False
        If .Show <> -1 Then GoTo TidyExit
        filePath = .SelectedItems(1)
    End With

    ' 3) Open with Excel's text parser and bring everything
    '    Accepts comma, semicolon, or tab delimited (covers most cases)
    Application.DisplayAlerts = False
    Workbooks.OpenText _
        Filename:=filePath, _
        DataType:=xlDelimited, _
        Comma:=True, _
        Semicolon:=True, _
        Tab:=True, _
        DecimalSeparator:=".", _
        ThousandsSeparator:=",", _
        Local:=True
    Application.DisplayAlerts = True

    Set wbTemp = ActiveWorkbook
    Set wsTemp = wbTemp.Sheets(1)

    ' Copy all data at once (headers + all rows/cols)
    wsDATA.Cells.Clear
    wsTemp.UsedRange.Copy Destination:=wsDATA.Range("A1")

    ' Close the temp workbook (no save)
    wbTemp.Close SaveChanges:=False

    ' Optional: tidy up view
    wsDATA.Columns.AutoFit

    MsgBox "Importación completa en DATA (todo el contenido).", vbInformation
    GoTo TidyExit

ErrHandler:
    MsgBox "Error en INT_ImportCSV_ToDATA_Simple: " & Err.Description, vbCritical

TidyExit:
    Application.EnableEvents = True
    Application.ScreenUpdating = True
End Sub